<div class="slds-p-around_medium task-wrapper">

  <div class="slds-grid slds-grid_align-spread slds-m-bottom_small">
    <div>
      <h1 class="slds-text-heading_medium">Tasks</h1>
      <p class="record-count">{{ totalRecords }} records</p>
    </div>

    <div class="slds-grid slds-grid_vertical-align-center">
      <input type="text" class="search-input" placeholder="Search" [(ngModel)]="searchText" (input)="onSearch()" />

      <button class="slds-button slds-button_brand slds-m-left_small" (click)="addTask()">
        New Task
      </button>

      <button class="slds-button slds-button_neutral slds-m-left_x-small" (click)="loadTasks()">
        Refresh
      </button>

      <button
  class="slds-button slds-button_destructive slds-m-left_x-small"
  [disabled]="selectedTaskIds.size === 0"
  (click)="openBulkDeleteModal()">
  Delete Selected
</button>

    </div>
  </div>

  <table class="slds-table slds-table_bordered">
    <thead>
      <tr>
        <th>
          <input
  type="checkbox"
  [checked]="isAllSelected()"
  (change)="toggleAll($event)"
>
        </th>
        <th>Assigned To</th>
        <th>Status</th>
        <th>Due Date</th>
        <th>Priority</th>
        <th>Comments</th>
        <th>Actions</th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let task of pagedTasks">
        <td>
          <input
  type="checkbox"
  [checked]="isSelected(task.id!)"
  (change)="toggleTask(task.id!, $event)"
>
        </td>
        <td class="link">{{ task.assignedTo }}</td>
        <td>{{ task.status }}</td>
        <td>{{ task.dueDate | date: 'dd/MM/yyyy' }}</td>
        <td>{{ task.priority }}</td>
        <td>{{ task.comments }}</td>
        <td class="action-cell">
          <div class="action-menu">
            ⋮
            <div class="dropdown">
              <div (click)="editTask(task.id!)">Edit</div>
              <div class="danger" (click)="openDeleteModal(task)">Delete</div>
            </div>
          </div>
        </td>
      </tr>
    </tbody>
  </table>

  <div class="table-footer">

  <div class="page-size-spinner">
    <input
      type="number"
      [value]="pageSize"
      readonly
    />

    <div class="spinner-buttons">
      <button (click)="increasePageSize()">▲</button>
      <button (click)="decreasePageSize()">▼</button>
    </div>
  </div>

  <div class="pagination">
    <button (click)="goToFirst()" [disabled]="page === 1">First</button>
    <button (click)="prevPage()" [disabled]="page === 1">Prev</button>

    <span class="page-number">{{ page }}</span>

    <button (click)="nextPage()" [disabled]="page === totalPages">Next</button>
    <button (click)="goToLast()" [disabled]="page === totalPages">Last</button>
  </div>

</div>

</div>

<section *ngIf="showDeleteModal" class="slds-modal slds-fade-in-open">
  <div class="slds-modal__container delete-modal">

    <header class="slds-modal__header delete-header">
      <h2>Delete</h2>
    </header>

    <div class="slds-modal__content delete-body">
      <p *ngIf="!isBulkDelete">
  Do you want to delete <strong>{{ deleteTaskName }}</strong>?
</p>

<p *ngIf="isBulkDelete">
  Do you want to delete <strong>{{ selectedTaskCount }}</strong> selected tasks?
</p>

    </div>

    <footer class="slds-modal__footer delete-footer">
      <button class="btn-no" (click)="closeDeleteModal()">No</button>
      <button class="btn-yes" (click)="confirmDelete()">Yes</button>
    </footer>

  </div>
</section>

<div *ngIf="showDeleteModal" class="slds-backdrop slds-backdrop_open"></div>

<div
  class="route-backdrop"
  *ngIf="isFormRouteActive()"
  (click)="closeFormModal()">
</div>

<div
  class="route-modal"
  *ngIf="isFormRouteActive()"
  (click)="$event.stopPropagation()">

  <router-outlet></router-outlet>

</div>


